module.exports=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BlinkTradeRest=t.BlinkTradeWS=t.Brokers=void 0;var i=r(1),o=n(i),s=r(2),u=n(s),a=r(25),c=n(a);t.Brokers=o.default,t.BlinkTradeWS=u.default,t.BlinkTradeRest=c.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={SURBITCOIN:1,VBTC:3,FOXBIT:4,TESTNET:5,URDUBIT:8,CHILEBIT:9}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var r={};for(var n in e)t.indexOf(n)<0&&Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),R=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(n)},l=r(3),f=n(l),d=(r(4),r(5)),E=r(10),I=r(6),D=r(11),T=r(12),p=n(T),_=r(13),y=n(_),O=function(e){function t(e){o(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.transport=e.transport||new y.default(e),r.session={},r}return u(t,e),c(t,[{key:"connect",value:function(e){return this.transport.connect(e)}},{key:"disconnect",value:function(){return this.transport.disconnect()}},{key:"send",value:function(e){return this.transport.sendMessageAsPromise(e)}},{key:"heartbeat",value:function(e){var t=this,r=new Date,n={MsgType:I.ActionMsgReq.HEARTBEAT,TestReqID:r.getTime(),SendTime:r.getTime()};return f.default.extend(new Promise(function(e,r){return t.send(n).then(function(t){return e(a({},t,{Latency:new Date(Date.now())-t.SendTime}))}).catch(r)})).nodeify(e)}},{key:"login",value:function(e,t){var n=this,i=e.username,o=e.password,s=e.secondFactor,u=e.brokerId,c=void 0;if(this.isNode){var R=r(24);c={UserAgent:R.type()+" "+R.release(),UserAgentLanguage:"en_US",UserAgentPlatform:R.platform()+" ("+R.arch()+")",UserAgentTimezoneOffset:(new Date).getTimezoneOffset()}}else c={UserAgent:window.navigator.userAgent,UserAgentLanguage:window.navigator.language,UserAgentPlatform:window.navigator.platform,UserAgentTimezoneOffset:(new Date).getTimezoneOffset()};var l=a({MsgType:I.ActionMsgReq.LOGIN,UserReqID:(0,d.generateRequestId)(),BrokerID:u||this.brokerId,Username:i,Password:o,UserReqTyp:"1"},c);return s&&(l.SecondFactor=s),f.default.extend(new Promise(function(e,t){return n.send(l).then(function(r){return 1===r.UserStatus?(n.session=r,e(r)):t(r)}).catch(t)})).nodeify(t)}},{key:"logout",value:function(e){var t={MsgType:I.ActionMsgReq.LOGOUT,BrokerID:this.brokerId,UserReqID:(0,d.generateRequestId)(),Username:this.session.Username,UserReqTyp:"2"};return f.default.extend(this.send(t)).nodeify(e)}},{key:"profile",value:function e(t){var r=this.session.Profile,e=i(r,["VerificationData"]);return f.default.extend(Promise.resolve(e)).nodeify(t)}},{key:"balance",value:function(e){var r=this;return this.transport.emitterPromise(new Promise(function(n,i){return R(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"balance",r).call(r,e).then(function(t){return(0,d.registerListener)(I.ActionMsgReq.BALANCE,function(t){return e&&e(null,t),r.transport.eventEmitter.emit(E.BALANCE,t)}),n(t)}).catch(i)}))}},{key:"subscribeTicker",value:function(e,t){var r=this,n={MsgType:I.ActionMsgReq.SECURITY_STATUS_SUBSCRIBE,SecurityStatusReqID:(0,d.generateRequestId)(),SubscriptionRequestType:"1",Instruments:e},i=function(e){return a({},e,{SellVolume:e.SellVolume/1e8,LowPx:e.LowPx/1e8,LastPx:e.LastPx/1e8,BestAsk:e.BestAsk/1e8,HighPx:e.HighPx/1e8,BuyVolume:e.BuyVolume/1e8,BestBid:e.BestBid/1e8})};return this.transport.emitterPromise(new Promise(function(e,o){return r.send(n).then(function(n){e(i(n)),(0,d.registerEventEmitter)("SecurityStatusReqID",n.SecurityStatusReqID,function(e){return t&&t(null,i(e)),r.transport.eventEmitter.emit(e.Market+":"+e.Symbol,i(e))})}).catch(o)}),t)}},{key:"unSubscribeTicker",value:function(e){var t={MsgType:I.ActionMsgReq.SECURITY_STATUS_SUBSCRIBE,SecurityStatusReqID:e,SubscriptionRequestType:"2"};return this.transport.sendMessage(t),e}},{key:"subscribeOrderbook",value:function(e,t){var r=this,n={MsgType:I.ActionMsgReq.MD_FULL_REFRESH,MDReqID:(0,d.generateRequestId)(),SubscriptionRequestType:"1",MarketDepth:0,MDUpdateType:"1",MDEntryTypes:["0","1","2"],Instruments:e},i=function(e){"3"===e.MDBkTyp&&e.MDIncGrp.map(function(e){var n={index:e.MDEntryPositionNo,price:e.MDEntryPx/1e8,size:e.MDEntrySize/1e8,side:"0"===e.MDEntryType?"buy":"sell",userId:e.UserID,orderId:e.OrderID,symbol:e.Symbol,time:""+new Date(e.MDEntryDate+" "+e.MDEntryTime)};switch(e.MDEntryType){case"0":case"1":var i="OB:"+E.EVENTS.ORDERBOOK[e.MDUpdateAction],o=a({},n,{type:i});return t&&t(null,o),r.transport.eventEmitter.emit(i,o);case"2":var s="OB:"+E.EVENTS.TRADES[e.MDUpdateAction],u=a({},n,{type:s});return t&&t(null,u),r.transport.eventEmitter.emit(s,u);case"4":break;default:return null}return null})};return this.transport.emitterPromise(new Promise(function(e,t){return r.send(n).then(function(t){return(0,d.registerEventEmitter)("MDReqID",t.MDReqID,i),e((0,D.formatOrderBook)(t,r.level))}).catch(function(e){return t(e)})}),t)}},{key:"unSubscribeOrderbook",value:function(e){var t={MsgType:I.ActionMsgReq.MD_FULL_REFRESH,MDReqID:e,MarketDepth:0,SubscriptionRequestType:"2"};return this.transport.sendMessage(t),e}},{key:"executionReport",value:function(e){var t=this;return(0,d.registerListener)("8",function(r){e&&e(r);var n=E.EVENTS.EXECUTION_REPORT[r.ExecType];return t.transport.eventEmitter.emit(E.EXECUTION_REPORT+":"+n,r)}),this.transport.eventEmitter}},{key:"tradeHistory",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.since,r=e.filter,n=e.page,i=void 0===n?0:n,o=e.pageSize,s=void 0===o?80:o,u=arguments[1],a={MsgType:I.ActionMsgReq.TRADE_HISTORY,TradeHistoryReqID:(0,d.generateRequestId)(),Page:i,PageSize:s};r&&r.length>0&&(a.Filter=r),t&&"number"==typeof t&&(a.Since=t);var c=(0,D.formatTradeHistory)(this.level);return f.default.extend(this.send(a).then(c)).nodeify(u)}},{key:"requestDeposit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.currency,n=void 0===r?"BTC":r,i=t.value,o=t.depositMethodId,s=arguments[1],u=function(t){return s&&s(null,t),e.transport.eventEmitter.emit(E.DEPOSIT_REFRESH,t)};return this.transport.emitterPromise(new Promise(function(t,r){return e.requestDeposit({currency:n,value:i,depositMethodId:o}).then(function(e){return(0,d.registerEventEmitter)("ClOrdID",e.ClOrdID,u),t(e)}).catch(r)}),s)}},{key:"onDepositRefresh",value:function(e){return new Promise(function(t){(0,d.registerListener)("U23",function(r){return e&&e(r),t(r)})})}},{key:"requestWithdraw",value:function(e,t){var r=this,n=e.amount,i=e.data,o=e.currency,s=void 0===o?"BTC":o,u=e.method,a=void 0===u?"bitcoin":u,c=function(e){return t&&t(null,e),r.transport.eventEmitter.emit(E.WITHDRAW_REFRESH,e)};return this.transport.emitterPromise(new Promise(function(e,t){return r.requestWithdraw({amount:n,data:i,currency:s,method:a}).then(function(t){return(0,d.registerEventEmitter)("ClOrdID",t.ClOrdID,c),e(t)}).catch(t)}),t)}},{key:"onWithdrawRefresh",value:function(e){return new Promise(function(t){(0,d.registerListener)("U9",function(r){return e&&e(r),t(r)})})}}]),t}(p.default);t.default=O},function(e,t){e.exports=require("nodeify")},function(e,t){e.exports=require("eventemitter2")},function(e,t,r){"use strict";function n(){return D}function i(){return parseInt(1e7*Math.random()+"",10)}function o(e){return D[e]}function s(e,t){var r=e[t.MsgType][1],n=t[r];return r+":"+n}function u(e){return E.get(s(d.MsgActionRes,e))}function a(e,t){E.set(s(d.MsgActionReq,e),t)}function c(e){E.delete(s(d.MsgActionRes,e))}function R(e){return I.get(s(d.MsgActionRes,e))}function l(e,t,r){I.set(e+":"+t,r)}function f(e,t){D.set(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getListeners=n,t.generateRequestId=i,t.getListener=o,t.getRequest=u,t.setRequest=a,t.deleteRequest=c,t.getEventEmitter=R,t.registerEventEmitter=l,t.registerListener=f;var d=r(6),E=new Map,I=new Map,D=new Map},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.ActionMsgRes=t.ActionMsgReq=t.MsgActionRes=t.MsgActionReq=void 0;var i=r(7),o=r(8),s=n(o),u=r(9),a=n(u),c=(0,i.compose)(i.invertObj,(0,i.map)(i.head)),R=t.MsgActionReq={1:[a.HEARTBEAT,s.TestReqID],BE:[a.LOGIN,s.UserReqID],V:[a.MD_FULL_REFRESH,s.MDReqID],x:[a.SECURITY_LIST,s.SecurityReqID],e:[a.SECURITY_STATUS_SUBSCRIBE,s.SecurityStatusReqID],D:[a.ORDER_SEND,s.ClOrdID],F:[a.ORDER_CANCEL,s.ClOrdID],U0:[a.SIGNUP,s.UserReqID],U2:[a.BALANCE,s.BalanceReqID],U6:[a.WITHDRAW_REQUEST,s.WithdrawReqID],U4:[a.ORDER_HISTORY,s.OrdersReqID],U18:[a.DEPOSIT_REQUEST,s.DepositReqID],U20:[a.DEPOSIT_METHODS,s.DepositMethodReqID],U24:[a.WITHDRAW_CONFIRM,s.WithdrawReqID],U26:[a.WITHDRAW_LIST,s.WithdrawListReqID],U28:[a.BROKER_LIST,s.BrokerListReqID],U30:[a.DEPOSIT_LIST,s.DepositListReqID],U32:[a.TRADE_HISTORY,s.TradeHistoryReqID],U34:[a.LEDGER_LIST,s.LedgerListReqID],U38:[a.PROFILE_UPDATE,s.UpdateReqID],U50:[a.API_KEY_LIST,s.APIKeyListReqID],U52:[a.API_KEY_CREATE,s.APIKeyCreateReqID],U54:[a.API_KEY_REVOKE,s.APIKeyRevokeReqID],U70:[a.WITHDRAW_CANCEL,s.WithdrawCancelReqID],U78:[a.WITHDRAW_COMMENT,s.WithdrawReqID],B0:[a.DEPOSIT_PROCESS,s.ProcessDepositReqID],B2:[a.CUSTOMER_LIST,s.CustomerListReqID],B4:[a.KYC_REQUEST,s.CustomerReqID],B6:[a.WITHDRAW_PROCESS,s.ProcessWithdrawReqID],B8:[a.KYC_VERIFY,s.VerifyCustomerReqID]},l=t.MsgActionRes={0:[a.HEARTBEAT,s.TestReqID],BF:[a.LOGIN,s.UserReqID],W:[a.MD_FULL_REFRESH,s.MDReqID],X:[a.MD_INCREMENT,s.MDReqID],8:[a.EXECUTION_REPORT,s.ClOrdID],y:[a.SECURITY_LIST,s.SecurityReqID],f:[a.SECURITY_STATUS_SUBSCRIBE,s.SecurityStatusReqID],U3:[a.BALANCE,s.BalanceReqID],U7:[a.WITHDRAW_REQUEST,s.WithdrawReqID],U5:[a.ORDER_HISTORY,s.OrdersReqID],U9:[a.WITHDRAW_REFRESH,s.WithdrawReqID],U19:[a.DEPOSIT_REQUEST,s.DepositReqID],U21:[a.DEPOSIT_METHODS,s.DepositMethodReqID],U23:[a.DEPOSIT_REFRESH,s.DepositReqID],U25:[a.WITHDRAW_CONFIRM,s.WithdrawReqID],U27:[a.WITHDRAW_LIST,s.WithdrawListReqID],U29:[a.BROKER_LIST,s.BrokerListReqID],U31:[a.DEPOSIT_LIST,s.DepositListReqID],U33:[a.TRADE_HISTORY,s.TradeHistoryReqID],U35:[a.LEDGER_LIST,s.LedgerListReqID],U39:[a.PROFILE_UPDATE,s.UpdateReqID],U51:[a.API_KEY_LIST,s.APIKeyListReqID],U53:[a.API_KEY_CREATE,s.APIKeyCreateReqID],U55:[a.API_KEY_REVOKE,s.APIKeyRevokeReqID],U71:[a.WITHDRAW_CANCEL,s.WithdrawCancelReqID],U79:[a.WITHDRAW_COMMENT,s.WithdrawCancelReqID],B1:[a.DEPOSIT_PROCESS,s.ProcessDepositReqID],B3:[a.CUSTOMER_LIST,s.CustomerListReqID],B5:[a.KYC_REQUEST,s.CustomerReqID],B9:[a.KYC_VERIFY,s.VerifyCustomerReqID],B7:[a.WITHDRAW_PROCESS,s.ProcessWithdrawReqID],B11:[a.CUSTOMER_REFRESH]};t.ActionMsgReq=c(R),t.ActionMsgRes=c(l)},function(e,t){e.exports=require("ramda")},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReqID="ReqID",t.TestReqID="TestReqID",t.UserReqID="UserReqID",t.SecurityReqID="SecurityReqID",t.ResetPasswordReqID="ResetPasswordReqID",t.DepositReqID="DepositReqID",t.WithdrawReqID="WithdrawReqID",t.BalanceReqID="BalanceReqID",t.OrdersReqID="OrdersReqID",t.EnableTwoFactorReqID="EnableTwoFactorReqID",t.DepositMethodReqID="DepositMethodReqID",t.WithdrawListReqID="WithdrawListReqID",t.WithdrawCancelReqID="WithdrawCancelReqID",t.BrokerListReqID="BrokerListReqID",t.DepositListReqID="DepositListReqID",t.TradeHistoryReqID="TradeHistoryReqID",t.LedgerListReqID="LedgerListReqID",t.TradersRankReqID="TradersRankReqID",t.UpdateReqID="UpdateReqID",t.PositionReqID="PositionReqID",t.SecurityStatusReqID="SecurityStatusReqID",t.APIKeyListReqID="APIKeyListReqID",t.APIKeyCreateReqID="APIKeyCreateReqID",t.APIKeyRevokeReqID="APIKeyRevokeReqID",t.ProcessDepositReqID="ProcessDepositReqID",t.CustomerListReqID="CustomerListReqID",t.CustomerReqID="CustomerReqID",t.ProcessWithdrawReqID="ProcessWithdrawReqID",t.VerifyCustomerReqID="VerifyCustomerReqID",t.MDReqID="MDReqID",t.ClOrdID="ClOrdID"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HEARTBEAT="HEARTBEAT",t.BROKER_LIST="BROKER_LIST",t.SECURITY_LIST="SECURITY_LIST",t.SECURITY_STATUS_UPDATE="SECURITY_STATUS_UPDATE",t.SECURITY_STATUS_SUBSCRIBE="SECURITY_STATUS_SUBSCRIBE",t.SECURITY_STATUS_UNSUBSCRIBE="SECURITY_STATUS_UNSUBSCRIBE",t.MD_TRADES="MD_TRADES",t.MD_TRADES_UNSUBSCRIBE="MD_TRADES_UNSUBSCRIBE",t.MD_INCREMENT="MD_INCREMENT",t.MD_FULL_REFRESH="MD_FULL_REFRESH",t.MD_UNSUBSCRIBE="MD_UNSUBSCRIBE",t.MD_OPENING="MD_OPENING",t.OB_NEW_ORDER="OB_NEW_ORDER",t.OB_UPDATE_ORDER="OB_UPDATE_ORDER",t.OB_DELETE_ORDER="OB_DELETE_ORDER",t.OB_DELETE_ORDERS_THRU="OB_DELETE_ORDERS_THRU",t.EXECUTION_REPORT="EXECUTION_REPORT",t.EXECUTION_REPORT_NEW="EXECUTION_REPORT_NEW",t.EXECUTION_REPORT_PARTIAL="EXECUTION_REPORT_PARTIAL",t.EXECUTION_REPORT_EXECUTION="EXECUTION_REPORT_EXECUTION",t.EXECUTION_REPORT_CANCELED="EXECUTION_REPORT_CANCELED",t.EXECUTION_REPORT_REJECTED="EXECUTION_REPORT_REJECTED",t.ORDER_HISTORY="ORDER_HISTORY",t.ORDER_SEND="ORDER_SEND",t.ORDER_CANCEL="ORDER_CANCEL",t.TRADE_NEW="TRADE_NEW",t.TRADE_HISTORY="TRADE_HISTORY",t.TRADES="TRADES",t.SIGNUP="SIGNUP",t.LOGIN="LOGIN",t.LOGOUT="LOGOUT",t.LOGIN_REQUIRED="LOGIN_REQUIRED",t.LOGIN_CLOSE="LOGIN_CLOSE",t.CHANGE_PASSWORD="CHANGE_PASSWORD",t.BALANCE="BALANCE",t.PROFILE_UPDATE="PROFILE_UPDATE",t.WITHDRAW_LIST="WITHDRAW_LIST",t.WITHDRAW_CANCEL="WITHDRAW_CANCEL",t.WITHDRAW_FILTER="WITHDRAW_FILTER",t.WITHDRAW_REFRESH="WITHDRAW_REFRESH",t.WITHDRAW_PROCESS="WITHDRAW_PROCESS",t.WITHDRAW_CONFIRM="WITHDRAW_CONFIRM",t.WITHDRAW_COMMENT="WITHDRAW_COMMENT",t.WITHDRAW_REQUEST="WITHDRAW_REQUEST",t.WITHDRAW_SET_NEW_VISIBLE="WITHDRAW_SET_NEW_VISIBLE",t.DEPOSIT_LIST="DEPOSIT_LIST",t.DEPOSIT_FILTER="DEPOSIT_FILTER",t.DEPOSIT_REFRESH="DEPOSIT_REFRESH",t.DEPOSIT_PROCESS="DEPOSIT_PROCESS",t.DEPOSIT_REQUEST="DEPOSIT_REQUEST",t.DEPOSIT_METHODS="DEPOSIT_METHODS",t.DEPOSIT_SET_NEW_VISIBLE="DEPOSIT_SET_NEW_VISIBLE",t.LEDGER_LIST="LEDGER_LIST",t.LEDGER_FILTER="LEDGER_FILTER"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.ORDER_BOOK_TRADE_NEW="TRADE_NEW",n=t.ORDER_BOOK_NEW_ORDER="NEW_ORDER",i=t.ORDER_BOOK_UPDATE_ORDER="UPDATE_ORDER",o=t.ORDER_BOOK_DELETE_ORDER="DELETE_ORDER",s=t.ORDER_BOOK_DELETE_ORDERS_THRU="DELETE_ORDERS_THRU",u=(t.EXECUTION_REPORT="EXECUTION_REPORT",t.EXECUTION_REPORT_NEW="NEW"),a=t.EXECUTION_REPORT_PARTIAL="PARTIAL",c=t.EXECUTION_REPORT_EXECUTION="EXECUTION",R=t.EXECUTION_REPORT_CANCELED="CANCELED",l=t.EXECUTION_REPORT_REJECTED="REJECTED";t.EVENTS={ORDERBOOK:{0:n,1:i,2:o,3:s},TRADES:{0:r},EXECUTION_REPORT:{0:u,1:a,2:c,4:R,8:l}}},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.formatOrderBook=t.formatTradeHistory=t.formatColumns=void 0;var i=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(7);t.formatColumns=function(e,t){return function(r){if(2===t){var s=(0,o.map)((0,o.zipObj)(r.Columns),r[e]);return Promise.resolve(i({},r,n({},e,s)))}return Promise.resolve(r)}},t.formatTradeHistory=function(e){return function(t){if(2===e){var r=(0,o.compose)((0,o.groupBy)((0,o.prop)("Market")),(0,o.map)((0,o.zipObj)(t.Columns)))(t.TradeHistoryGrp);return Promise.resolve(i({},t,{TradeHistoryGrp:r}))}return Promise.resolve(t)}},t.formatOrderBook=function(e,t){if(2===t){var r=e.MDFullGrp.filter(function(e){return"0"===e.MDEntryType||"1"===e.MDEntryType}).reduce(function(e,t){var r="0"===t.MDEntryType?"bids":"asks";return(e[r]||(e[r]=[])).push([t.MDEntryPx/1e8,t.MDEntrySize/1e8,t.UserID,t.OrderID]),e},[]),o=r.bids,s=r.asks;return i({},e,{MDFullGrp:n({},e.Symbol,{bids:o,asks:s})})}return e}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(3),u=n(s),a=r(6),c=r(11),R=r(5),l=function(){function e(t){i(this,e),this.level=t.level,this.brokerId=t.brokerId}return o(e,[{key:"changeBrokerId",value:function(e){this.brokerId=e}},{key:"balance",value:function(e,t){var r={MsgType:a.ActionMsgReq.BALANCE,BalanceReqID:(0,R.generateRequestId)()};return e&&(r.ClientID=e),u.default.extend(this.send(r)).nodeify(t)}},{key:"myOrders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,r=void 0===t?0:t,n=e.pageSize,i=void 0===n?40:n,o=e.filter,s=arguments[1],l={MsgType:a.ActionMsgReq.ORDER_HISTORY,OrdersReqID:(0,R.generateRequestId)(),Page:r,PageSize:i};o&&(l.Filter=o);var f=(0,c.formatColumns)("OrdListGrp",this.level);return u.default.extend(this.send(l).then(f)).nodeify(s)}},{key:"sendOrder",value:function(e,t){var r=e.side,n=e.amount,i=e.price,o=e.symbol,s={MsgType:a.ActionMsgReq.ORDER_SEND,ClOrdID:(0,R.generateRequestId)(),Symbol:o,Side:r,OrdType:"2",Price:i,OrderQty:n,BrokerID:this.brokerId};return u.default.extend(this.send(s)).nodeify(t)}},{key:"cancelOrder",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=e.orderId?e.orderId:e,n={MsgType:a.ActionMsgReq.ORDER_CANCEL};return e.clientId&&(n.ClOrdID=e.clientId),e.orderId&&(n.OrderID=r),u.default.extend(this.send(n)).nodeify(t)}},{key:"requestWithdrawList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,r=void 0===t?0:t,n=e.pageSize,i=void 0===n?20:n,o=e.status,s=void 0===o?["1","2","4","8"]:o,l=e.filter,f=e.clientId,d=arguments[1],E={MsgType:a.ActionMsgReq.WITHDRAW_LIST,WithdrawListReqID:(0,R.generateRequestId)(),Page:r,PageSize:i,StatusList:s};l&&l.length&&(E.Filter=l),f&&(E.ClientID=f);var I=(0,c.formatColumns)("WithdrawListGrp",this.level);return u.default.extend(this.send(E).then(I)).nodeify(d)}},{key:"requestWithdraw",value:function(e,t){var r=e.amount,n=e.data,i=e.currency,o=void 0===i?"BTC":i,s=e.method,c=void 0===s?"bitcoin":s,l=(0,R.generateRequestId)(),f={MsgType:a.ActionMsgReq.WITHDRAW_REQUEST,WithdrawReqID:l,ClOrdID:l,Method:c,Amount:r,Currency:o,Data:n};return u.default.extend(this.send(f)).nodeify(t)}},{key:"confirmWithdraw",value:function(e,t){var r=e.withdrawId,n=e.confirmationToken,i=e.secondFactor,o={MsgType:a.ActionMsgReq.CONFIRM_WITHDRAW,WithdrawReqID:(0,R.generateRequestId)(),WithdrawID:r};return n&&(o.ConfirmationToken=n),i&&(o.SecondFactor=i),u.default.extend(this.send(o)).nodeify(t)}},{key:"cancelWithdraw",value:function(e,t){var r=(0,R.generateRequestId)(),n={MsgType:a.ActionMsgReq.CANCEL_WITHDRAW,WithdrawCancelReqID:r,ClOrdID:r,WithdrawID:e};return u.default.extend(this.send(n)).nodeify(t)}},{key:"requestDepositList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,r=void 0===t?0:t,n=e.pageSize,i=void 0===n?20:n,o=e.status,s=void 0===o?["1","2","4","8"]:o,l=e.filter,f=e.clientId,d=arguments[1],E={MsgType:a.ActionMsgReq.DEPOSIT_LIST,DepositListReqID:(0,R.generateRequestId)(),Page:r,PageSize:i,StatusList:s};l&&l.length&&(E.Filter=l),f&&(E.ClientID=f);var I=(0,c.formatColumns)("DepositListGrp",this.level);return u.default.extend(this.send(E).then(I)).nodeify(d)}},{key:"requestDeposit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.currency,r=void 0===t?"BTC":t,n=e.value,i=e.depositMethodId,o=arguments[1],s=(0,R.generateRequestId)(),c={MsgType:a.ActionMsgReq.DEPOSIT_REQUEST,DepositReqID:s,ClOrdID:s,Currency:r,BrokerID:this.brokerId};return"BTC"!==r&&(c.DepositMethodID=i,c.Value=n),u.default.extend(this.send(c)).nodeify(o)}},{key:"requestDepositMethods",value:function(e){var t={MsgType:a.ActionMsgReq.DEPOSIT_METHODS,DepositMethodReqID:(0,R.generateRequestId)(),BrokerID:this.brokerId};return u.default.extend(this.send(t)).nodeify(e)}},{key:"requestLedger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,r=void 0===t?0:t,n=e.pageSize,i=void 0===n?20:n,o=e.brokerId,s=e.clientId,l=e.currency,f=arguments[1],d={MsgType:a.ActionMsgReq.LEDGER_LIST,LedgerListReqID:(0,R.generateRequestId)(),BrokerID:this.brokerId,Page:r,PageSize:i};o&&(d.BrokerID=o),l&&(d.Currency=l),s&&(d.ClientID=s);var E=(0,c.formatColumns)("LedgerListGrp",this.level);return u.default.extend(this.send(d).then(E)).nodeify(f)}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(3),c=n(a),R=r(14),l=n(R),f=r(4),d=r(15),E=n(d),I=r(5),D=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"ws"));return r.stun={local:null,public:[]},r.getStun(),r.getFingerPrint(e.fingerPrint),r.headers=e.headers,r.eventEmitter=new f.EventEmitter2({wildcard:!0,delimiter:":"}),r}return s(t,e),u(t,[{key:"connect",value:function(e){var t=this;return c.default.extend(new Promise(function(e,n){t.request={resolve:e,reject:n};var i=t.isNode?r(17):window.WebSocket;t.socket=new i(t.endpoint,null,t.headers),t.socket.onopen=t.onOpen.bind(t),t.socket.onclose=t.onClose.bind(t),t.socket.onerror=t.onError.bind(t),t.socket.onmessage=t.onMessage.bind(t)})).nodeify(e)}},{key:"disconnect",value:function(){this.socket.close()}},{key:"onOpen",value:function(){this.request.resolve({connected:!0})}},{key:"onClose",value:function(){}},{key:"onError",value:function(e){this.request.reject(e)}},{key:"sendMessage",value:function(e){if(1===this.socket.readyState){var t=e;t.STUNTIP=this.stun,t.FingerPrint=this.fingerPrint,this.socket.send(JSON.stringify(t))}}},{key:"sendMessageAsPromise",value:function(e){var t=this;return new Promise(function(r,n){var i={resolve:r,reject:n};(0,I.setRequest)(e,{resolve:r,reject:n}),t.sendMessage(e,i)})}},{key:"onMessage",value:function(e){var t=JSON.parse(e.data);if("ERROR"===t.MsgType)throw Error("Error: "+t.Detail+" "+t.Description);var r=(0,I.getRequest)(t),n=(0,I.getEventEmitter)(t),i=(0,I.getListener)(t.MsgType);this.dispatchPromise(r,t),this.dispatchEventEmitters(n,t),this.dispatchListeners(i,t)}},{key:"dispatchPromise",value:function(e,t){if(e&&e.resolve)return(0,I.deleteRequest)(t),e.resolve(t)}},{key:"dispatchEventEmitters",value:function(e,t){if(e)return e(t)}},{key:"dispatchListeners",value:function(e,t){return e&&e(t)}},{key:"getFingerPrint",value:function(e){var t=this;if(this.isNode)return r(18).getMac(function(e){t.fingerPrint=e});if(this.isBrowser)return(new l.default).get(function(e){t.fingerPrint=""+Math.abs(r(20).encodeByteArray(e))});if(!e)throw Error("FingerPrint not provided");this.fingerPrint=e}},{key:"getStun",value:function(){var e=this;this.isNode&&r(21).getStun(function(t){e.stun=t})}},{key:"emitterPromise",value:function(e,t){var r=this;return e.on=function(t,n){return r.eventEmitter.on(t,n),e},e.onAny=function(t){return r.eventEmitter.onAny(t),e},e.offAny=function(t){return r.eventEmitter.offAny(t),e},e.once=function(t,n){return r.eventEmitter.once(t,n),e},e.many=function(t,n,i){return r.eventEmitter.many(t,n,i),e},e.removeListener=function(t,n){return r.eventEmitter.removeListener(t,n),e},e.removeAllListeners=function(t){return r.eventEmitter.removeAllListeners(t),e},c.default.extend(e).nodeify(t)}}]),t}(E.default);t.default=D},function(e,t){e.exports=require("fingerprintjs2")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=r(16),s=n(o),u=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];i(this,e);var n=t.url?t.url:t.prod?s.default.prod[r]:s.default.testnet[r];this.endpoint=n,this.level=t.level||"2",this.isNode="undefined"==typeof window,this.isBrowser="undefined"!=typeof document};t.default=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={prod:{ws:"wss://ws.blinktrade.com/trade/",rest:"https://api.blinktrade.com/"},testnet:{ws:"wss://api_testnet.blinktrade.com/trade/",rest:"https://api_testnet.blinktrade.com/"}}},function(e,t){e.exports=require("ws")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){s.default.all(function(t,r){var n=function(e){var t=0;if(0===e.length)return t;for(var r=0;e.length>r;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t},i="";Object.keys(r).forEach(function(e){i+=r[e].mac});var o=n(i);0>o&&(o*=-1),e(o)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getMac=i;var o=r(19),s=n(o)},function(e,t){e.exports=require("macaddress")},function(e,t){"use strict";var r=314159265,n=-1640531527,i=function(e){var t=e.a,r=e.b,n=e.c;return t-=r,t-=n,t^=n>>>13,r-=n,r-=t,r^=t<<8,n-=t,n-=r,n^=r>>>13,t-=r,t-=n,t^=n>>>12,r-=n,r-=t,r^=t<<16,n-=t,n-=r,n^=r>>>5,t-=r,t-=n,t^=n>>>3,r-=n,r-=t,r^=t<<10,n-=t,n-=r,n^=r>>>15,e.a=t,e.b=r,e.c=n,n},o=function(e){return e>127?e-256:e},s=function(e,t){var r=o(e[t+0]),n=o(e[t+1]),i=o(e[t+2]),s=o(e[t+3]);return r+(n<<8)+(i<<16)+(s<<24)};e.exports.encodeByteArray=function(e){var t,o=0,u=e.length,a=r,c={a:n,b:n,c:a};for(t=u;t>=12;t-=12,o+=12)c.a+=s(e,o),c.b+=s(e,o+4),c.c+=s(e,o+8),i(c);switch(c.c+=u,t){case 11:c.c+=e[o+10]<<24;case 10:c.c+=(255&e[o+9])<<16;case 9:c.c+=(255&e[o+8])<<8;case 8:c.b+=s(e,o+4),c.a+=s(e,o);break;case 7:c.b+=(255&e[o+6])<<16;case 6:c.b+=(255&e[o+5])<<8;case 5:c.b+=255&e[o+4];case 4:c.a+=s(e,o);break;case 3:c.a+=(255&e[o+2])<<16;case 2:c.a+=(255&e[o+1])<<8;case 1:c.a+=255&e[o+0]}return i(c)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){e.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)?l.local=e:l.public.indexOf(e)===-1&&l.public.push(e)}function o(e){var t=R.default.createSocket("udp4"),r=20,n=new Buffer(r),o=0,u=1,c=554869826,f=Math.pow(2,32),d=1,E=32800,I=32,D=Math.random()*f,T=[[3478,"stun.services.mozilla.com"],[19302,"stun.l.google.com"],[3478,"stun.stunprotocol.org"],[3478,"stun.softjoys.com"],[3478,"stun.samsungsmartcam.com"],[3478,"stun.sonetel.com"],[3478,"stun.tagan.ru"],[3478,"stun.voipgain.com"],[3478,"stunserver.org"],[3478,"stun.advfn.com"],[3478,"stun.annatel.net"],[3478,"stun.freevoipdeal.com"]];n.writeUInt16BE(16383&(u|o),0),n.writeUInt16BE(0,2),n.writeUInt32BE(c,4),n.writeUInt32BE(0,8),n.writeUInt32BE(0,12),n.writeUInt32BE(D,16),t.on("message",function(t){var n=function(e,t){var r=[];if(t.length>e.length){var n=e;e=t,t=n}for(var i=0,o=e.length;o>i;i++)r.push(e[i]^t[i]);return new Buffer(r)},o=t.readUInt8(0),s=128&o,u=64&o;if(0===s&&0===u){for(var c=t.slice(0,r),R=t.slice(r,t.length),f=0;R.length>f;){var D=R.readUInt16BE(f);f+=2;var T=R.readUInt16BE(f),p=T%4;p>0&&(T+=4-p),f+=2;var _=R.slice(f,f+T);f+=T;var y=void 0,O=void 0;switch(D){case d:y=2===_.readUInt16BE(0)?6:4,O=a.default.toString(_,4,y),i(O);break;case E:case I:y=2===_.readUInt16BE(0)?6:4;var v=c.slice(4,8),h=c.slice(8,20),S=_.slice(4,4===y?8:20),g=n(S,4===y?v:_.concat([v,h]));O=a.default.toString(g,0,y),i(O)}}e(l)}}),T.map(function(e){var r=s(e,2),i=r[0],o=r[1];return t.send(n,0,n.length,i,o,function(){})})}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getStun=o;var u=r(22),a=n(u),c=r(23),R=n(c),l={local:null,public:[]}},function(e,t){e.exports=require("ip")},function(e,t){e.exports=require("dgram")},function(e,t){e.exports=require("os")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(3),c=n(a),R=r(26),l=n(R),f=r(12),d=n(f),E=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.transport=e.transport||new l.default(e),r}return s(t,e),u(t,[{key:"send",value:function(e){return this.transport.fetchTrade(e)}},{key:"fetchPublic",value:function(e){return this.transport.fetchPublic(e)}},{key:"ticker",value:function(e){return c.default.extend(this.fetchPublic("ticker")).nodeify(e)}},{key:"trades",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.limit,r=void 0===t?100:t,n=e.since,i=void 0===n?0:n,o=arguments[1];return c.default.extend(this.fetchPublic("trades?limit="+r+"&since="+i)).nodeify(o);
}},{key:"orderbook",value:function(e){return c.default.extend(this.fetchPublic("orderbook")).nodeify(e)}}]),t}(d.default);t.default=E},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(27),c=n(a),R=r(28),l=n(R),f=r(29),d=n(f),E=r(15),I=n(E),D=(0,d.default)(Promise),T=D.fetch,p=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"rest"));return r.key=e.key,r.secret=e.secret,r.currency=e.currency||"USD",r}return s(t,e),u(t,[{key:"headers",value:function(e,t){var r=""+Date.now(),n=l.default.codec.utf8String.toBits(this.secret),i=new l.default.misc.hmac(n,l.default.hash.sha256),o=l.default.codec.hex.fromBits(i.encrypt(r));return{method:e,headers:{"Content-Type":"application/json",Nonce:r,APIKey:this.key,Signature:o},body:JSON.stringify(t)}}},{key:"fetch",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return T(c.default.resolve(this.endpoint,t),r).then(function(e){return e.json()})}},{key:"fetchPublic",value:function(e){return this.fetch({},"api/v1/"+this.currency+"/"+e)}},{key:"fetchTrade",value:function(e){var t=this.headers("POST",e);return this.fetch(e,"tapi/v1/message",t).then(function(e){return 500===e.Status?Promise.reject(e):e.Responses}).then(function(e){return 1===e.length?e[0]:e})}}]),t}(I.default);t.default=p},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("sjcl")},function(e,t){e.exports=require("fetch-ponyfill")}]);
//# sourceMappingURL=blinktrade.min.js.map